<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

<h2>üé° ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h2>

<textarea id="nameInput" rows="6" cols="20">
1
2
3
4
</textarea><br>

<button id="spinBtn">‡∏´‡∏°‡∏∏‡∏ô‡∏ß‡∏á‡∏•‡πâ‡∏≠</button>

<canvas id="wheel" width="300" height="300"></canvas>

<script>
/* ================== ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏•‡πá‡∏≠‡∏Å ================== */
const LOCK_INDEX = 1; // 0 = ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏£‡∏Å, 1 = ‡∏ä‡∏∑‡πà‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
/* ================================================= */

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const cx = canvas.width / 2;
const cy = canvas.height / 2;
const r  = canvas.width / 2;

const spinBtn = document.getElementById("spinBtn");
const nameInput = document.getElementById("nameInput");

let names = [];
let angle = 0;
let spinning = false;

/* ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ */
function loadNames() {
  names = nameInput.value
    .split("\n")
    .map(s => s.trim())
    .filter(Boolean);
}

/* ‡∏ß‡∏≤‡∏î‡∏ß‡∏á‡∏•‡πâ‡∏≠ */
function drawWheel() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (names.length === 0) return;

  const slice = (Math.PI * 2) / names.length;

  for (let i = 0; i < names.length; i++) {
    const start = angle + i * slice;
    const end = start + slice;

    ctx.beginPath();
    ctx.moveTo(cx, cy);
    ctx.arc(cx, cy, r, start, end);
    ctx.fillStyle = `hsl(${i * 360 / names.length},70%,60%)`;
    ctx.fill();

    // ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
    ctx.save();
    ctx.translate(cx, cy);
    ctx.rotate(start + slice / 2);
    ctx.textAlign = "right";
    ctx.font = "23px Arial";
    ctx.fillStyle = "#000";
    ctx.fillText(names[i], r - 10, 5);
    ctx.restore();
  }

  // ‡∏•‡∏π‡∏Å‡∏®‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏µ‡πâ‡∏•‡∏á)
  const arrowOffsetY = 0; // ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô/‡∏•‡∏á‡πÑ‡∏î‡πâ
  ctx.fillStyle = "black";
  ctx.beginPath();
  ctx.moveTo(cx, 10 + arrowOffsetY);       // ‡∏¢‡∏≠‡∏î‡∏ö‡∏ô
  ctx.lineTo(cx - 10, 0 + arrowOffsetY); // ‡∏ã‡πâ‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏á
  ctx.lineTo(cx + 10, 0 + arrowOffsetY); // ‡∏Ç‡∏ß‡∏≤‡∏•‡πà‡∏≤‡∏á
  ctx.closePath();
  ctx.fill();
}

/* ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô */
spinBtn.addEventListener("click", spin);

/* ‡∏ß‡∏≤‡∏î‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ */
loadNames();
drawWheel();

/* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ ‚Üí ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ */
nameInput.addEventListener("input", () => {
  loadNames();
  drawWheel();
});

/* ================== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô spin() ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà ================== */
function spin() {
  if (spinning) return;
  loadNames();
  if (names.length === 0) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠");

  const slice = (Math.PI * 2) / names.length;

  // --- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏≠‡∏ö‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° + ‡∏•‡πá‡∏≠‡∏Å‡∏ú‡∏• ---
  const minSpins = 40;   // ‡∏£‡∏≠‡∏ö‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î
  const maxSpins = 80;  // ‡∏£‡∏≠‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
  const spins = Math.floor(Math.random() * (maxSpins - minSpins + 1)) + minSpins;

  const targetAngle =
    Math.PI * 2 * spins
    - Math.PI / 2
    - (LOCK_INDEX * slice)
    - (slice / 2);

  const startAngle = angle;
  const startTime = performance.now();
  const duration = 10000; // ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏∏‡∏ô (ms)

  spinning = true;

  function animate(time) {
    const t = Math.min((time - startTime) / duration, 1);

    // easing ‡πÅ‡∏ö‡∏ö cubic-out (‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ ‡∏ä‡∏∞‡∏•‡∏≠)
    const ease = 1 - Math.pow(1 - t, 3);

    angle = startAngle + (targetAngle - startAngle) * ease;
    drawWheel();

    if (t < 1) {
      requestAnimationFrame(animate);
    } else {
      spinning = false;
      alert("üéØ ‡πÑ‡∏î‡πâ‡∏ä‡∏∑‡πà‡∏≠: " + names[LOCK_INDEX]);
    }
  }

  requestAnimationFrame(animate);
}


/* ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô */
spinBtn.addEventListener("click", spin);

/* ‡∏ß‡∏≤‡∏î‡∏ß‡∏á‡∏•‡πâ‡∏≠‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ */
loadNames();
drawWheel();

/* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ ‚Üí ‡∏ß‡∏á‡∏•‡πâ‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ */
nameInput.addEventListener("input", () => {
  loadNames();
  drawWheel();
});
</script>

</body>
</html>

